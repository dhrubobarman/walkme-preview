var T=Object.defineProperty;var P=(o,t,e)=>t in o?T(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var r=(o,t,e)=>P(o,typeof t!="symbol"?t+"":t,e);function d(o,t,e=!1){let i=document.createElement(o);return t&&Object.assign(i,t),typeof e=="string"?document.querySelector(e)?.appendChild(i):e===!0?document.querySelector("#app")?.appendChild(i):typeof e=="object"&&e.appendChild?.(i),i}var w=()=>d("div",{className:"walkme-container"},"body"),b=o=>{let{className:t,variant:e="primary",...i}=o||{};return d("button",{className:`${{primary:"py-2.5 px-5 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 ",secondary:"text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-900 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700",tertiary:"text-gray-900 bg-white focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}[e]} ${t} disabled:cursor-auto disabled:pointer-events-none`,...i})},f=o=>{let{className:t,...e}=o||{};return d("h3",{className:`mb-3 text-xl font-medium text-gray-900 dark:text-white ${t}`,...e})},y=o=>{let{className:t,...e}=o||{};return d("p",{className:`mb-5 text-sm text-gray-500 dark:text-gray-300 ${t}`,...e})},v=o=>{let{className:t,...e}=o||{};return d("div",{className:`walkme-card max-w-sm w-[24rem] p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 ${t}`,...e})},x=({windowPosition:o,className:t,padding:e=8,...i})=>{let n=d("div",{className:`fixed top-0 left-0 right-0 bottom-0 bg-black/50 z-50 mix-blend-hard-light ${t}`,style:{mixBlendMode:"hard-light"},...i}),a=d("div",{className:"fixed rounded-md bg-[gray] bg-blend-lighten transition-all duration-200",style:{backgroundBlendMode:"lighten"},...i});n.appendChild(a);let s=c=>{let{top:p=0,left:h=0,width:l=0,height:m=0,borderRadius:C=6}=c||{},D=p-e,z=h-e,E=l+e*2,R=m+e*2;a.style.borderRadius=`${Math.max(C,6)}px`,a.style.top=`${D}px`,a.style.left=`${z}px`,a.style.width=`${E}px`,a.style.height=`${R}px`};return s(o),{outerDiv:n,innerWindowDiv:a,handleChangeWindowPosition:s}},k=o=>{let{className:t,dotsCount:e,...i}=o||{},n=["bg-gray-800","dark:bg-white"],a=["bg-gray-300","dark:bg-gray-500"],s=Array.from({length:e}).map(()=>d("div",{className:"w-2 h-2 rounded-full mx-1"})),c=d("div",{className:`flex justify-center mb-2 items-center ${t}`,...i}),p=h=>{s.forEach((l,m)=>{m===h?(l.classList.add(...n),l.classList.remove(...a)):(l.classList.add(...a),l.classList.remove(...n))})};return p(0),c.append(...s),{container:c,changeActiveDotIndex:p}};var u=class{constructor({walkme:t,handleSteps:e}){r(this,"walkme");r(this,"card",v({className:"fixed z-[51]  transition-all duration-300"}));r(this,"title",f({className:"border-b border-gray-200 dark:border-gray-700 pb-3"}));r(this,"description",y());r(this,"nextButton",b({innerText:"Next",variant:"secondary",className:"next-button"}));r(this,"prevButton",b({innerText:"Prev",variant:"primary",className:"prev-button"}));r(this,"skipButton",b({innerText:"Skip",variant:"tertiary",className:"skip-button"}));r(this,"statusDots");r(this,"padding",8);r(this,"overlay",x({windowPosition:{top:0,left:0,width:0,height:0},padding:this.padding}));r(this,"cardRect",this.card.getBoundingClientRect());r(this,"walkmeContainer",w());r(this,"handleSteps");this.walkme=t,this.handleSteps=e,this.statusDots=k({dotsCount:this.handleSteps.steps.length}),this.attachClickEvents()}attachClickEvents(){this.nextButton.onclick=()=>this.handleSteps.next(),this.prevButton.onclick=()=>this.handleSteps.prev(),this.skipButton.onclick=()=>this.handleSteps.skip()}start(){this.walkmeContainer.appendChild(this.overlay.outerDiv),document.body.style.overflow="hidden",this.card.appendChild(this.title),this.card.appendChild(this.description),this.card.appendChild(this.statusDots.container);let t=d("div",{className:"flex justify-between gap-2 border-t border-gray-200 dark:border-gray-700 pt-3 items-center"});t.appendChild(this.prevButton),t.appendChild(this.skipButton),t.appendChild(this.nextButton),this.card.appendChild(t)}stop(){this.walkmeContainer.innerHTML="",document.body.style.overflow=""}initCardWithMessages(t){this.nextButton.disabled=this.handleSteps.isNextButtonDisabled,this.prevButton.disabled=this.handleSteps.isPrevButtonDisabled,this.statusDots.changeActiveDotIndex(this.handleSteps.currentIndex),this.handleSteps.currentIndex===this.handleSteps.steps.length-1?(this.nextButton.disabled=!1,this.nextButton.innerText="Finish"):this.nextButton.innerText="Next",this.title.innerHTML=t.title,this.description.innerHTML=t.description||"";let e=parseInt(getComputedStyle(t.element).borderRadius);this.overlay.handleChangeWindowPosition({top:t.elementRect.top,left:t.elementRect.left,width:t.elementRect.width,height:t.elementRect.height,borderRadius:e}),this.walkmeContainer.appendChild(this.card),this.cardRect=this.card.getBoundingClientRect()}placeCardOverTarget(t){let e=t.elementRect,i=window.innerWidth,n=window.innerHeight,a=e.top+e.height+this.padding,s=e.left+e.width*.5-this.cardRect.width*.5;e.bottom+this.cardRect.height>n&&(a=e.top-this.cardRect.height-this.padding),s+this.cardRect.width*.5>i&&(s=i-this.cardRect.width),s<0&&(s=0),a<0&&(a=0),this.card.style.top=`${a}px`,this.card.style.left=`${s}px`}showCurrentStep(t){this.initCardWithMessages(t),this.placeCardOverTarget(t)}};var g=class{constructor({walkme:t}){r(this,"steps");r(this,"currentIndex");r(this,"walkme");r(this,"currentStep");r(this,"started");r(this,"isNextButtonDisabled",!1);r(this,"isPrevButtonDisabled",!1);r(this,"found",!1);r(this,"interval");r(this,"maxIntervalCount",10);r(this,"currentStepDetails",null);r(this,"stepUI");r(this,"resizeObserver",null);r(this,"initial",!0);r(this,"debouncedResize",this.debounce(()=>{if(this.initial){this.initial=!1;return}this.showCurrentStep()},500));this.walkme=t,this.steps=t.stepData.steps,this.currentIndex=t.currentIndex,this.currentStep=this.steps[this.currentIndex],this.started=t.started,this.stepUI=new u({walkme:this.walkme,handleSteps:this})}attachResizeEventListeners(){this.resizeObserver=new ResizeObserver(()=>{this.debouncedResize()}),this.resizeObserver.observe(document.body)}boundKeyboardEvent(t){t.preventDefault(),t.stopPropagation(),this.found&&(t.key==="ArrowRight"||t.key==="Enter"?this.next():t.key==="ArrowLeft"&&this.prev())}attachKeyboardListener(){document.addEventListener("keydown",this.boundKeyboardEvent.bind(this))}removeKeyboardListener(){document.removeEventListener("keydown",this.boundKeyboardEvent.bind(this))}async getStepDetails(){if(!this.currentStep||!this.currentStep.target)return null;let t=document.querySelector(this.currentStep.target);if(!t)return null;try{await this.smoothScroll(t)}catch(i){let n=new Error(`Something went wrong while scrolling into the target: ${this.currentStep.target}`);this.walkme.onError(n),console.error(i)}let e=t.getBoundingClientRect();return this.currentStepDetails={element:t,elementRect:e,...this.currentStep},this.currentStepDetails}debounce(t,e){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>{t(...n)},e)}}getCurrentStepDetails(){return new Promise((t,e)=>{this.found=!1,this.started||e("WalkMe has not started yet."),this.maxIntervalCount<=0&&(clearInterval(this.interval),e(`Element not found with target: ${this.currentStep.target}`)),this.interval=setInterval(async()=>{this.maxIntervalCount--;let i=await this.getStepDetails();i&&(this.maxIntervalCount=10,this.found=!0,clearInterval(this.interval),t(i))},500)})}smoothScroll(t,e={behavior:"smooth",block:"center",inline:"center"}){return new Promise(i=>{if(!(t instanceof Element))throw new TypeError("Argument 1 must be an Element");let n=0,a=null,s=null,c=Object.assign({behavior:"smooth"},e);t.scrollIntoView(c),requestAnimationFrame(p);function p(){let{top:h,left:l}=t.getBoundingClientRect();if(h===a&&l===s){if(n++>2)return i(!0)}else n=0,s=l,a=h;requestAnimationFrame(p)}})}disableButtons(){if(this.currentIndex===this.steps.length-1){this.isNextButtonDisabled=!0;return}else this.isNextButtonDisabled=!1;if(this.currentIndex===0){this.isPrevButtonDisabled=!0;return}else this.isPrevButtonDisabled=!1}async showCurrentStep(){try{let t=await this.getCurrentStepDetails();this.stepUI.showCurrentStep(t)}catch(t){let e=t;this.walkme.onError(e)}}next(){if(this.currentIndex++,this.disableButtons(),this.currentIndex===this.steps.length){this.finish();return}this.currentStep=this.steps[this.currentIndex],this.showCurrentStep()}prev(){this.currentIndex!==0&&(this.currentIndex--,this.disableButtons(),this.currentStep=this.steps[this.currentIndex],this.showCurrentStep())}start(){this.disableButtons(),this.walkme.started&&(this.started=!0,this.stepUI.start(),this.showCurrentStep(),this.attachResizeEventListeners(),this.attachKeyboardListener())}stop(){this.removeKeyboardListener(),this.resizeObserver?.disconnect(),this.stepUI.stop()}finish(){this.removeKeyboardListener(),this.resizeObserver?.disconnect(),this.stepUI.stop(),this.walkme.finish()}skip(){this.removeKeyboardListener(),this.resizeObserver?.disconnect(),this.walkme.skip()}};var S=class{constructor({stepData:t,onError:e=a=>console.error(a),onFinish:i,onSkip:n}){r(this,"stepData");r(this,"isReady",!1);r(this,"currentIndex",0);r(this,"onError");r(this,"onFinish");r(this,"onSkip");r(this,"started",!1);r(this,"handleSteps");this.stepData=t,this.onError=e,this.onFinish=i,this.onSkip=n,this.isReady=!0,this.handleSteps=new g({walkme:this})}start(){this.started=!0,this.handleSteps.start()}stop(){this.handleSteps.stop(),this.started=!1,this.currentIndex=0,this.handleSteps=new g({walkme:this})}skip(){this.onSkip&&this.onSkip(this.stepData),this.stop()}finish(){this.stepData.learned=!0,this.onFinish&&this.onFinish(this.stepData),this.stop()}};export{S as Walkme};
//# sourceMappingURL=index.js.map