"use strict";var b=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var M=Object.prototype.hasOwnProperty;var I=(i,t,e)=>t in i?b(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var B=(i,t)=>{for(var e in t)b(i,e,{get:t[e],enumerable:!0})},H=(i,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of L(t))!M.call(i,a)&&a!==e&&b(i,a,{get:()=>t[a],enumerable:!(o=P(t,a))||o.enumerable});return i};var N=i=>H(b({},"__esModule",{value:!0}),i);var r=(i,t,e)=>I(i,typeof t!="symbol"?t+"":t,e);var O={};B(O,{Walkme:()=>f});module.exports=N(O);function d(i,t,e=!1){let o=document.createElement(i);return t&&Object.assign(o,t),typeof e=="string"?document.querySelector(e)?.appendChild(o):e===!0?document.querySelector("#app")?.appendChild(o):typeof e=="object"&&e.appendChild?.(o),o}var y=()=>d("div",{className:"walkme-container"},"body"),u=i=>{let{className:t,variant:e="primary",...o}=i||{};return d("button",{className:`${{primary:"py-2.5 px-5 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 ",secondary:"text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-900 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700",tertiary:"text-gray-900 bg-white focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}[e]} ${t} disabled:cursor-auto disabled:pointer-events-none`,...o})},v=i=>{let{className:t,...e}=i||{};return d("h3",{className:`mb-3 text-xl font-medium text-gray-900 dark:text-white ${t}`,...e})},x=i=>{let{className:t,...e}=i||{};return d("p",{className:`mb-5 text-sm text-gray-500 dark:text-gray-300 ${t}`,...e})},k=i=>{let{className:t,...e}=i||{};return d("div",{className:`walkme-card max-w-sm w-[24rem] p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 ${t}`,...e})},S=({windowPosition:i,className:t,padding:e=8,...o})=>{let a=d("div",{className:`fixed top-0 left-0 right-0 bottom-0 bg-black/50 z-50 mix-blend-hard-light ${t}`,style:{mixBlendMode:"hard-light"},...o}),n=d("div",{className:"fixed rounded-md bg-[gray] bg-blend-lighten transition-all duration-200",style:{backgroundBlendMode:"lighten"},...o});a.appendChild(n);let s=c=>{let{top:p=0,left:h=0,width:l=0,height:w=0,borderRadius:D=6}=c||{},z=p-e,E=h-e,R=l+e*2,T=w+e*2;n.style.borderRadius=`${Math.max(D,6)}px`,n.style.top=`${z}px`,n.style.left=`${E}px`,n.style.width=`${R}px`,n.style.height=`${T}px`};return s(i),{outerDiv:a,innerWindowDiv:n,handleChangeWindowPosition:s}},C=i=>{let{className:t,dotsCount:e,...o}=i||{},a=["bg-gray-800","dark:bg-white"],n=["bg-gray-300","dark:bg-gray-500"],s=Array.from({length:e}).map(()=>d("div",{className:"w-2 h-2 rounded-full mx-1"})),c=d("div",{className:`flex justify-center mb-2 items-center ${t}`,...o}),p=h=>{s.forEach((l,w)=>{w===h?(l.classList.add(...a),l.classList.remove(...n)):(l.classList.add(...n),l.classList.remove(...a))})};return p(0),c.append(...s),{container:c,changeActiveDotIndex:p}};var m=class{constructor({walkme:t,handleSteps:e}){r(this,"walkme");r(this,"card",k({className:"fixed z-[51]  transition-all duration-300"}));r(this,"title",v({className:"border-b border-gray-200 dark:border-gray-700 pb-3"}));r(this,"description",x());r(this,"nextButton",u({innerText:"Next",variant:"secondary",className:"next-button"}));r(this,"prevButton",u({innerText:"Prev",variant:"primary",className:"prev-button"}));r(this,"skipButton",u({innerText:"Skip",variant:"tertiary",className:"skip-button"}));r(this,"statusDots");r(this,"padding",8);r(this,"overlay",S({windowPosition:{top:0,left:0,width:0,height:0},padding:this.padding}));r(this,"cardRect",this.card.getBoundingClientRect());r(this,"walkmeContainer",y());r(this,"handleSteps");this.walkme=t,this.handleSteps=e,this.statusDots=C({dotsCount:this.handleSteps.steps.length}),this.attachClickEvents()}attachClickEvents(){this.nextButton.onclick=()=>this.handleSteps.next(),this.prevButton.onclick=()=>this.handleSteps.prev(),this.skipButton.onclick=()=>this.handleSteps.skip()}start(){this.walkmeContainer.appendChild(this.overlay.outerDiv),document.body.style.overflow="hidden",this.card.appendChild(this.title),this.card.appendChild(this.description),this.card.appendChild(this.statusDots.container);let t=d("div",{className:"flex justify-between gap-2 border-t border-gray-200 dark:border-gray-700 pt-3 items-center"});t.appendChild(this.prevButton),t.appendChild(this.skipButton),t.appendChild(this.nextButton),this.card.appendChild(t)}stop(){this.walkmeContainer.innerHTML="",document.body.style.overflow=""}initCardWithMessages(t){this.nextButton.disabled=this.handleSteps.isNextButtonDisabled,this.prevButton.disabled=this.handleSteps.isPrevButtonDisabled,this.statusDots.changeActiveDotIndex(this.handleSteps.currentIndex),this.handleSteps.currentIndex===this.handleSteps.steps.length-1?(this.nextButton.disabled=!1,this.nextButton.innerText="Finish"):this.nextButton.innerText="Next",this.title.innerHTML=t.title,this.description.innerHTML=t.description||"";let e=parseInt(getComputedStyle(t.element).borderRadius);this.overlay.handleChangeWindowPosition({top:t.elementRect.top,left:t.elementRect.left,width:t.elementRect.width,height:t.elementRect.height,borderRadius:e}),this.walkmeContainer.appendChild(this.card),this.cardRect=this.card.getBoundingClientRect()}placeCardOverTarget(t){let e=t.elementRect,o=window.innerWidth,a=window.innerHeight,n=e.top+e.height+this.padding,s=e.left+e.width*.5-this.cardRect.width*.5;e.bottom+this.cardRect.height>a&&(n=e.top-this.cardRect.height-this.padding),s+this.cardRect.width*.5>o&&(s=o-this.cardRect.width),s<0&&(s=0),n<0&&(n=0),this.card.style.top=`${n}px`,this.card.style.left=`${s}px`}showCurrentStep(t){this.initCardWithMessages(t),this.placeCardOverTarget(t)}};var g=class{constructor({walkme:t}){r(this,"steps");r(this,"currentIndex");r(this,"walkme");r(this,"currentStep");r(this,"started");r(this,"isNextButtonDisabled",!1);r(this,"isPrevButtonDisabled",!1);r(this,"found",!1);r(this,"interval");r(this,"maxIntervalCount",10);r(this,"currentStepDetails",null);r(this,"stepUI");r(this,"resizeObserver",null);r(this,"initial",!0);r(this,"debouncedResize",this.debounce(()=>{if(this.initial){this.initial=!1;return}this.showCurrentStep()},500));this.walkme=t,this.steps=t.stepData.steps,this.currentIndex=t.currentIndex,this.currentStep=this.steps[this.currentIndex],this.started=t.started,this.stepUI=new m({walkme:this.walkme,handleSteps:this})}attachResizeEventListeners(){this.resizeObserver=new ResizeObserver(()=>{this.debouncedResize()}),this.resizeObserver.observe(document.body)}boundKeyboardEvent(t){t.preventDefault(),t.stopPropagation(),this.found&&(t.key==="ArrowRight"||t.key==="Enter"?this.next():t.key==="ArrowLeft"&&this.prev())}attachKeyboardListener(){document.addEventListener("keydown",this.boundKeyboardEvent.bind(this))}removeKeyboardListener(){document.removeEventListener("keydown",this.boundKeyboardEvent.bind(this))}async getStepDetails(){if(!this.currentStep||!this.currentStep.target)return null;let t=document.querySelector(this.currentStep.target);if(!t)return null;try{await this.smoothScroll(t)}catch(o){let a=new Error(`Something went wrong while scrolling into the target: ${this.currentStep.target}`);this.walkme.onError(a),console.error(o)}let e=t.getBoundingClientRect();return this.currentStepDetails={element:t,elementRect:e,...this.currentStep},this.currentStepDetails}debounce(t,e){let o;return(...a)=>{clearTimeout(o),o=setTimeout(()=>{t(...a)},e)}}getCurrentStepDetails(){return new Promise((t,e)=>{this.found=!1,this.started||e("WalkMe has not started yet."),this.maxIntervalCount<=0&&(clearInterval(this.interval),e(`Element not found with target: ${this.currentStep.target}`)),this.interval=setInterval(async()=>{this.maxIntervalCount--;let o=await this.getStepDetails();o&&(this.maxIntervalCount=10,this.found=!0,clearInterval(this.interval),t(o))},500)})}smoothScroll(t,e={behavior:"smooth",block:"center",inline:"center"}){return new Promise(o=>{if(!(t instanceof Element))throw new TypeError("Argument 1 must be an Element");let a=0,n=null,s=null,c=Object.assign({behavior:"smooth"},e);t.scrollIntoView(c),requestAnimationFrame(p);function p(){let{top:h,left:l}=t.getBoundingClientRect();if(h===n&&l===s){if(a++>2)return o(!0)}else a=0,s=l,n=h;requestAnimationFrame(p)}})}disableButtons(){if(this.currentIndex===this.steps.length-1){this.isNextButtonDisabled=!0;return}else this.isNextButtonDisabled=!1;if(this.currentIndex===0){this.isPrevButtonDisabled=!0;return}else this.isPrevButtonDisabled=!1}async showCurrentStep(){try{let t=await this.getCurrentStepDetails();this.stepUI.showCurrentStep(t)}catch(t){let e=t;this.walkme.onError(e)}}next(){if(this.currentIndex++,this.disableButtons(),this.currentIndex===this.steps.length){this.finish();return}this.currentStep=this.steps[this.currentIndex],this.showCurrentStep()}prev(){this.currentIndex!==0&&(this.currentIndex--,this.disableButtons(),this.currentStep=this.steps[this.currentIndex],this.showCurrentStep())}start(){this.disableButtons(),this.walkme.started&&(this.started=!0,this.stepUI.start(),this.showCurrentStep(),this.attachResizeEventListeners(),this.attachKeyboardListener())}stop(){this.removeKeyboardListener(),this.resizeObserver?.disconnect(),this.stepUI.stop()}finish(){this.removeKeyboardListener(),this.resizeObserver?.disconnect(),this.stepUI.stop(),this.walkme.finish()}skip(){this.removeKeyboardListener(),this.resizeObserver?.disconnect(),this.walkme.skip()}};var f=class{constructor({stepData:t,onError:e=n=>console.error(n),onFinish:o,onSkip:a}){r(this,"stepData");r(this,"isReady",!1);r(this,"currentIndex",0);r(this,"onError");r(this,"onFinish");r(this,"onSkip");r(this,"started",!1);r(this,"handleSteps");this.stepData=t,this.onError=e,this.onFinish=o,this.onSkip=a,this.isReady=!0,this.handleSteps=new g({walkme:this})}start(){this.started=!0,this.handleSteps.start()}stop(){this.handleSteps.stop(),this.started=!1,this.currentIndex=0,this.handleSteps=new g({walkme:this})}skip(){this.onSkip&&this.onSkip(this.stepData),this.stop()}finish(){this.stepData.learned=!0,this.onFinish&&this.onFinish(this.stepData),this.stop()}};
//# sourceMappingURL=index.cjs.map